<div>
<font color=Blue size=6>Chapter 1 Introduction</font> 
</div>

# Tasks: solve ODEs/PDEs

https://www.youtube.com/watch?v=bSRjZ2B-D3U

# terms
DeepParticle：一种基于深度神经网络的分布映射方法,用于学习和预测动力系统的不变测度。
Normalizing Flows (NF)：一种用于分布映射的技术,要求映射函数是可逆的。
Generative Adversarial Networks (GAN)：一种用于分布映射的对抗性生成网络,训练目标是min-max。
Sinkhorn Distances：一种基于熵正则化的分布距离度量。
Fisher information regularization：一种用于分布映射的正则化方法。
Invariant measure：动力系统的不变测度,描述系统的长期行为。
Interacting Particle Method (IPM)：一种基于粒子互作的数值方法,用于生成训练数据。
2-Wasserstein distance：一种基于Wasserstein距离的分布距离度量,作为DeepParticle方法的优化目标。
Rectiﬁed Linear Unit (ReLU)：一种常用的神经网络激活函数。
Sigmoid function：另一种常用的神经网络激活函数。

# invariant measures
简单来说,invariant measures指的是在某个偏微分方程系统的动力学演化过程中,保持不变的概率测度。也就是说,这个概率测度在方程的时间演化下是不变的。

对于一个给定的PDE系统,寻找其invariant measures通常是一个非常有意义的研究目标,因为它可以提供关于系统长期行为的重要信息。具体来说,invariant measures可以帮助我们:

描述系统的稳定态分布和平衡态性质。
分析系统的ergodic性质,即系统是否能够遍历其相空间。
研究系统的统计力学性质,例如热力学量的计算。
建立PDE的随机表示,从而简化数学分析。
确定PDE系统的invariant measures通常需要结合Liouville定理、Fokker-Planck方程、无穷小生成元理论等数学工具,这是一个非平凡的数学问题。不同的PDE系统可能拥有不同的invariant measures,这反映了系统的复杂动力学特性

# IPM
IPM是一种基于粒子互作的数值方法,用于生成训练数据。IPM的基本思想是,通过模拟粒子的相互作用,生成具有真实物理意义的训练数据。

IPM的基本思想是:用一组相互作用的粒子来近似描述整个系统的行为。每个粒子都代表系统中的一个基本单元,粒子之间会根据一定的相互作用规则进行运动和相互作用。通过对大量粒子的集体行为进行模拟,可以还原出整个系统的整体动态特性。



IPM的主要应用包括:

流体力学中的湍流模拟
材料科学中的微观结构演化
生物系统中的群体行为建模
金融市场的agent-based模拟

具体来说,IPM的工作流程如下:

1. 定义粒子的动力学方程。
2. 随机初始化粒子的位置和速度。
3. 迭代地模拟粒子的相互作用,直到满足收敛条件。
4. 收集模拟结果,作为训练数据。


IPM的优点是:

1. 可以模拟复杂的动力学系统,包括具有复杂相互作用、多种粒子、多种相互作用、非线性、分歧、热力学性质等复杂性。能够处理复杂的非线性相互作用,适用于建模涉及粒子之间复杂耦合的系统。能够捕捉系统动力学的整体性质,如集体行为、相变等宏观特征。
2. 可以生成具有真实物理意义的训练数据,因为模拟结果可以反映真实系统的物理特性。可以自然地引入随机性和不确定性,更接近真实系统的复杂性。
3. 计算开销相对较低,可以模拟大规模系统。可以有效地处理大数据量的问题,因为模拟粒子的相互作用可以并行化。

IPM的缺点是:

1. 模拟粒子的相互作用是一个复杂的计算问题,需要高效的并行算法。
2. 模拟结果的精度受到粒子的初始条件的影响,需要对粒子的初始条件进行适当的调整。
3. 模拟结果的可靠性依赖于模拟的迭代次数,迭代次数越多,模拟结果的精度越高,但模拟时间也越长。


# other
Particle Swarm Optimization (PSO):
基于群体智能的优化算法,在2023年8月之前广泛应用于各种优化问题的求解。

PSO的核心思想是模拟鸟群或鱼群的集体行为。算法中包含一群"粒子",每个粒子代表一个潜在的解决方案。粒子在搜索空间中移动,并根据自身的历史最优解和全局最优解来更新自己的位置和速度。

具体来说,PSO算法的工作流程如下:

初始化:随机生成一群粒子,给每个粒子分配随机的位置和速度。
评估:计算每个粒子的适应度值,即目标函数的值。
更新历史最优:比较每个粒子的当前适应度和历史最优,更新历史最优位置。
更新全局最优:比较所有粒子的历史最优,更新全局最优位置。
更新粒子位置和速度:根据粒子的历史最优和全局最优,更新粒子的位置和速度。
迭代:重复步骤2-5,直到满足终止条件。
PSO的主要优点包括:

简单易实现,计算开销较低
具有快速收敛性和良好的全局搜索能力
不需要导数信息,适用于非光滑、非凸优化问题
容易并行化,可以利用GPU加速计算
PSO广泛应用于连续型优化问题,如工程设计优化、资源调度、机器学习等领域。它是群智能算法家族中的一个重要成员,与遗传算法、蚁群算法等相比有其独特的优势。


interacting particle method (IPM)和Particle Swarm Optimization (PSO)确实存在一些联系,但它们也有明显的区别。

相似之处:
都使用一组"粒子"来模拟和分析复杂系统的行为。
粒子之间存在相互作用和信息交换,体现了群体智能的特点。
两种方法都利用粒子的集体行为来逼近系统的整体动态特性。
不同之处:
IPM主要应用于模拟物理系统中粒子的相互作用,如流体力学、材料科学等。
PSO则主要用于数学优化问题的求解,如工程设计优化、机器学习等。
IPM更注重模拟粒子动力学本身,而PSO更注重利用粒子群体来搜索最优解。
IPM中粒子之间的相互作用规则通常由物理定律决定,而PSO中粒子的运动规则是基于启发式的优化策略。
IPM的理论基础更多来自统计物理和非线性动力学,PSO则源自群体智能和启发式优化。
总的来说,尽管IPM和PSO都利用了粒子群体的集体行为,但它们的应用背景和侧重点有所不同。IPM更多关注物理系统的建模和仿真,而PSO更关注优化问题的求解。但两种方法在某些领域也可能会有交叉和融合的应用场景。



# solving invariant measures
## IPM

interacting particle method (IPM)可以用来求解复杂系统的不变测度(invariant measures),这是一个重要的问题。

在IPM中,不变测度表示系统在长时间演化后达到的一个稳定的概率分布。这个分布反映了系统的内在动力学特性,是理解复杂系统行为的关键。

求解不变测度的IPM方法通常包括以下步骤:

1. 建立粒子系统模型:根据实际复杂系统,构建一组相互作用的粒子来描述系统的动力学。给每个粒子分配初始状态和相互作用规则。
2. 模拟粒子演化:让粒子系统在一定时间内演化,观察粒子的运动轨迹和整体行为。
3. 统计分析粒子状态:对大量粒子的状态进行统计分析,得到粒子状态分布的稳定形式,即不变测度。
4. 提取特征量:从不变测度中提取有意义的特征,如平均值、方差、相关函数等,用以描述系统的整体行为。
通过这个过程,我们可以从微观粒子行为中提取出宏观尺度下系统的稳态特性。这种自下而上的建模方法可以很好地捕捉复杂系统的整体动力学,克服了基于偏微分方程的顶层建模方法的局限性。

IPM求解不变测度的优点包括:

能够处理非线性、非平衡的复杂系统
可以引入随机性和不确定性,更接近真实系统
计算成本相对较低,适用于大规模系统
可以提取系统的宏观特性,给出洞见
总之,IPM为我们研究复杂系统的不变测度提供了一种强大而富有洞见的数值分析工具。

## DP
深度粒子方法(Deep Particle Method, DPM)是近年来发展起来的一种新型的粒子模拟方法,它结合了粒子方法和深度学习技术,在复杂系统建模和仿真中展现出很大的潜力。

深度粒子方法的核心思想如下:

使用神经网络来建模和近似粒子之间的相互作用规则。相比于传统的手工设计相互作用算子,神经网络可以自动学习从数据中提取复杂的相互作用模式。
利用深度学习的强大表达能力,DPM可以有效地捕捉系统中的多尺度、多物理场耦合效应,从而更准确地模拟复杂系统的整体行为。
通过端到端的训练,DPM可以直接从观测数据中学习出符合实际物理规律的粒子动力学模型,而无需事先知道系统的详细微观机制。
DPM具有良好的泛化能力,训练好的模型可以应用到新的初始条件和边界条件下,大幅提高了仿真效率。
DPM可以无缝集成到深度学习框架中,利用GPU加速等技术,实现快速高效的大规模粒子模拟。
总的来说,深度粒子方法结合了粒子方法的灵活性和深度学习的强大表达能力,为复杂系统建模开辟了新的可能性。它在流体力学、材料科学、生物医学等领域都有广泛的应用前景。

DPM的关键技术包括粒子编码、相互作用建模、端到端训练等,涉及计算物理学、机器学习等多个学科。

minibatch/domain decomposition

DP: unif -> mapped distribution
IPM: mapped distribution -> invariant measures
unif -> mapped distribution -> invariant measures







DeepParticle方法确实在学习复杂系统的不变测度方面有一些独特的优势,与传统方法相比有以下几个重要的区别:

建模方式不同:
传统方法往往需要基于系统的微观机理手工设计粒子相互作用算子
DeepParticle直接利用神经网络学习相互作用规则,避免了这一困难
数据驱动vs机理驱动:
传统方法需要很好地理解系统的内部机理才能构建合适的模型
DeepParticle则是从数据出发,通过机器学习自动提取不变测度
模型适应性:
传统方法对于新的系统通常需要重新建模
DeepParticle训练好的模型具有很强的迁移能力,可应用于不同系统
优化目标不同:
传统方法通常基于最小化某种误差函数
DeepParticle采用最小化Wasserstein距离的方式更好地匹配分布
计算效率:
传统数值方法计算量大,特别是对于高维复杂系统
DeepParticle利用深度学习的GPU加速,计算speed大幅提升




DeepParticle方法虽然在某些方面优于传统方法,但也存在一些值得注意的局限性和挑战,使用者需要谨慎考虑:

数据依赖性:
DeepParticle方法需要大量高质量的训练数据,这对于某些复杂系统可能很困难获得
如果训练数据不具有代表性,学习到的不变测度可能会存在偏差
泛化能力限制:
由于深度学习模型的特性,DeepParticle可能难以很好地推广到完全不同的系统
对于一些结构复杂的系统,网络难以捕捉全部潜在的相互作用机制
解释性不足:
与基于机理的传统方法相比,DeepParticle作为一个黑盒模型,难以解释学习到的不变测度分布
计算开销:
训练深度学习模型需要大量的计算资源和时间,对于某些实时应用可能不太合适
缺乏理论保证:
目前DeepParticle方法缺乏严格的数学分析,无法确保所学习的不变测度是准确的
对初始条件敏感:
由于复杂系统本身的特性,DeepParticle方法可能对初始条件比较敏感




3 experiments to verify the performance of the proposed DeepParticle method. 

1. synthetic data set on R1, where µ is a uniform distribution and ν is a normal distribution with zero mean and variance σ2
Mapping uniform to normal distribution

2. Kolmogorov-Petrovsky-Piskunov (KPP) front speed in a 2D steady cellular flow and learn the invariant measures corresponding to different κ’s. 

3. KPP front speed in a 3D time-dependent Kolmogorov flow with chaotic streamlines and study the IPM evolution
of the measure in three-dimensional space. 